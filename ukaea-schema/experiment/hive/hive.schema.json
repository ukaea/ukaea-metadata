{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "urn:ukaea:experiment:hive-schema",
    "description": "HIVE scientific metadata schema",
    "type": "object",
    "required": [
        "pulse_information",
        "sample_information",
        "coolant_information",
        "current_heating_information",
        "extra_information",
        "diagnostic_setup"
    ],
    "properties": {
        "pulse_information": {
            "type": "object",
            "required": [ "pulse_id", "pulse_type" ],
            "properties": {
                "pulse_id": { 
                    "type": "string",
                    "comment": "regex-able"
                },
                "pulse_type": { 
                    "type": "string",
                    "enum": [ "Commissioning", "Test" ]
                }
            }
        },
        "sample_information": {
            "type": "object",
            "required": [ "sample_id", "sample_cooling" ],
            "properties": {
                "sample_id": { 
                    "type": "string",
                    "comment": "regex-able"
                },
                "sample_cooling": {
                    "type": "boolean"
                }
            }
        },
        "coolant_information": {
            "type": "object",
            "required": [ "coolant_type", "coolant_flow", "coolant_temperature" ],
            "properties": {
                "coolant_type": { 
                    "type": "string",
                    "enum": [ "Water", "NotWater" ]
                },
                "coolant_flow": {
                    "type": "number",
                    "unit": "qudt:L-PER-MIN"
                },
                "coolant_temperature": {
                    "type": "number",
                    "unit": "qudt:DEG_C"
                },
                "coolant_delta_temp": { 
                    "type": "number",
                    "unit": "qudt:DEG_C",
                    "description": "Coolant delta temperature across the sample."
                },
                "coolant_delta_pressure": { 
                    "type": "number",
                    "unit": "qudt:BAR"
                }
            }
        },
        "current_heating_information": {
            "type": "object",
            "required": [ "current_type", "input_power" ],
            "properties": {
                "current_type": {
                    "type": "string",
                    "enum": [ "AC", "DC" ]
                },
                "input_power": {
                    "type": "number",
                    "unit": "qudt:KiloW"
                },
                "input_voltage": {
                    "type": "number",
                    "unit": "qudt:V"
                },
                "input_current": {
                    "type": "number",
                    "unit": "qudt:A"
                },
                "output_frequency": {
                    "type": "number",
                    "unit": "qudt:KiloHZ"
                },
                "output_voltage": {
                    "type": "number",
                    "unit": "qudt:V"
                },
                "output_current": {
                    "type": "number",
                    "unit": "qudt:A"
                },
                "output_power": {
                    "type": "number",
                    "unit": "qudt:KiloW"
                },
                "pulse_duration": {
                    "type": "number",
                    "unit": "qudt:SEC"
                }
            }
        },
        "extra_information": {
            "comment": "talk to Stephen and James",
            "type": "object",
            "required": [ "sample_max_temp" ],
            "properties": {
                "sample_max_temp": {
                    "type": "number",
                    "unit": "qudt:DEG_C"
                },
                "IR_max_temp": {
                    "type": "number",
                    "unit": "qudt:DEG_C"
                },
                "pyro_max_temp": {
                    "type": "number",
                    "unit": "qudt:DEG_C"
                },
                "calometric_heat_transfer": {
                    "type": "number",
                    "unit": "qudt:W"
                },
                "radiative_heat_loss": {
                    "type": "number",
                    "unit": "qudt:W"
                },
                "est_power_into_sample": {
                    "type": "number",
                    "unit": "qudt:W"
                },
                "est_heat_flux": {
                    "type": "number",
                    "unit": "qudt:W-PER-M2"
                }
            }
        },
        "diagnostic_setup": {
            "type": "object",
            "properties": {
                "diagnostics": {
                    "type": "array",
                    "items": {
                        "oneOf": [
                            { "$ref": "./diagnostics/dic.schema.json" },
                            { "$ref": "./diagnostics/tc.schema.json" }
                        ]
                    }
                } 
            }
        }
    }
}
